
<Label>:
    font_name: 'ui/fonts/Gotham-Book.ttf'
    font_size: '22sp'
    text_size: self.width-self.padding_x, self.height-self.padding_y
    padding: ('50sp', '5sp')
    valign: 'middle'
    halign: 'center'
    line_height: 1.3


<StatusBar>:
    size: 2048, 150
    y: 1536 - (150*self.alpha_show)
    size_hint: None, None

    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: 0,0
            size: self.size
            source: "ui/images/statusbarbg.png"

    Label:
        text: "Question: {0}/5".format(root.questions_left)
        size: 2048, 150
        halign: 'left'
        size_hint: None, None
        text_size: 2000, 150

    Label:
        text: "Score: {0}".format(root.score)
        halign: 'right'
        size: 2048, 150
        size_hint: None, None
        text_size: 2000, 150

<ScreenManager>:
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'ui/images/bg.png'


<IntroScreen>:
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'ui/screens/intro/bg.png'

    Button:
        size: 800,250
        size_hint: None, None
        center: root.center_x, root.center_y - 200
        background_normal: 'ui/screens/intro/btn.png'
        background_down: 'ui/screens/intro/btn_down.png'
        on_release: app.start_quiz()



<QuestionScreen>:
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'ui/screens/question/bg.png'

    on_reset: [x.reset() for x in (opt1, opt2, opt3, opt4)]

    BoxLayout:
        orientation: 'vertical'

        Label:
            text: root.text
            markup: True
            font_name: 'ui/fonts/Gotham-Bold.ttf'
            font_size: '28sp'
            halign: 'left'
            size_hint: None, 1
            width: root.width - 250

        GridLayout:
            on_parent: root.button_grid = self
            cols: 2
            padding: '20dp'
            spacing: '20dp'

            QuestionButton:
                id: opt1
                text: root.option_a
                on_release: app.check_answer(root, self, 1)
            QuestionButton:
                id: opt2
                text: root.option_b
                on_release: app.check_answer(root, self, 2)
            QuestionButton:
                id: opt3
                text: root.option_c
                on_release: app.check_answer(root, self, 3)
            QuestionButton:
                id: opt4
                text: root.option_d
                on_release: app.check_answer(root, self, 4)


<QuestionButton>:
    font_name: 'ui/fonts/Gotham-Bold.ttf' if self.alpha_rotation < 0.5 else 'ui/fonts/Gotham-Book.ttf'
    halign: 'center' if self.alpha_rotation < 0.5 else 'left'
    font_size: '22sp' if self.alpha_rotation < 0.5 else '14sp'
    background_normal: "ui/screens/question/qbg.png"
    background_down: "ui/screens/question/qbg_down.png"
    background_wrong: "ui/screens/question/qbg_wrong.png"


<AnswerScreen>:
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'ui/screens/answer/bg.png'

    BoxLayout:
        orientation: 'vertical'
        Widget:
            size_hint_y: None
            height: 150
        Label:
            font_name: 'ui/fonts/Gotham-Bold.ttf'
            font_size: '76sp'
            height: '100sp'
            halign: 'left'
            valign: 'bottom'
            size_hint_y: None
            text: root.feedback
        Label:
            halign: 'left'
            font_size: '24sp'
            valign: 'top'
            text: root.text+"\n"
        Widget:
            size_hint_y: None
            height: 500



    ScrollView:
        do_scroll_y: False
        size_hint: 1, None
        height: 500

        canvas.before:
            Color:
                rgba: 1,0,0,0.4
            Rectangle:
                pos: self.pos
                size: self.size

        ThumnailList:
            padding: 50
            spacing: 50
            size_hint: None, None
            height: 500
            minimum_width: self.width
            on_parent: root.image_layout = self


    Button:
        on_release: app.next_question()
        background_normal: "ui/screens/answer/nextbtn.png"
        background_down: "ui/screens/answer/nextbtn_down.png"
        size_hint: None, None
        size: 200,200
        right: root.right - 50
        y: 50




<ResultsScreen>:
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'ui/screens/results/bg.png'

    BoxLayout:
        orientation:'vertical'
        Label:
            font_name: 'ui/fonts/Gotham-Bold.ttf'
            font_size: '38sp'
            size_hint: 1, 0.5
            text: root.text
    Button:
        on_release: app.screen_manager.current = 'intro'
        size: 800,250
        size_hint: None, None
        center_x: root.center_x
        background_normal: 'ui/screens/results/donebtn.png'
        background_down: 'ui/screens/results/donebtn_down.png'
        y: 200

<ProgressionView>:
    auto_dismiss: False
	background: 'ui/screens/loading/loading-logo.png'
	border: (0, 0, 0, 0)

	AnchorLayout:

		BoxLayout:
			size_hint: None, None
			size: ('400sp', '250sp')
			orientation: 'vertical'
			padding: '50dp'
			Label:
				text: root.text
			ProgressBar:
				value: root.progression

<AnswerImage>:
    mipmap: True
    allow_stretch: True

<AnswerImagePopup>:
    scatter: scatter
    background_color: (0, 0, 0, 1.0)
    background: 'ui/screens/answer/imageviewbg.png'

    ScatterPlane:
        id: scatter
        opacity: root.alpha
        scale_min: 1.0
        on_center_x: self.center_x = min(max(0,self.center_x), root.height)
        on_center_y: self.center_y = min(max(0,self.center_y), root.height)
        AsyncImage:
            mipmap: True
            source: root.answer.img_data['full']
            # for positionning, take care of the label
            size: root.width - dp(100), root.height - dp(150)
            pos: dp(50), dp(100)

    FloatLayout:
        Image:
            size: 150,150
            x: root.width - self.width - 20
            y: root.height - self.height - 20
            source: "ui/screens/answer/imageviewclose.png"
            size_hint: None, None
            on_touch_down: root.dismiss() if self.collide_point(*args[1].pos) else None

        Label:
            text: root.answer.text or ''
            size_hint_y: None
            height: '50sp'
            font_size: '12sp'
            y: -(1 - root.alpha) * self.height
            on_touch_down: root.dismiss() if self.collide_point(*args[1].pos) else None

            canvas.before:
                Color:
                    rgba: .05, .05, .05, .9
                Rectangle:
                    pos: self.pos
                    size: self.size
